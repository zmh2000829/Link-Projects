<!DOCTYPE html>
<html>
<head>
  <title>定制你的2020：复旦专属头像来袭！</title>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="css/index3.css">
  <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes"/>
  <script type="text/javascript" src="./html2canvas.min.js"></script>
  <!-- <script src="https://cdn.bootcss.com/html2canvas/0.4.1/html2canvas.js"></script> -->
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/cropper.css">
  <link rel="stylesheet" href="css/myCrop.css">
 <!--  <link rel="stylesheet" type="text/css" href="css/public.css"> -->
</head>
<body>
 <!--  <div class="loading">
    <div class="pic">
        <i></i>
        <i></i>
        <i></i>
        <i></i>
        <i></i>
    </div>
</div> -->
  <div id="content">
    <div id = "Home">
      <div id="back">
        <img src="img/3backg.jpg" style="width:100%">
      </div>
      <div class="square" style="position: absolute;width: 65%;left: 18.5%;top: 21.5%;">
            <img src="img/square.png" style="width: 100%;opacity: 0;display: block;z-index: 1">
            
            
        <div id = "icon" align="center" style="text-align:center">
          <div id = "oo" style="z-index:-1">
<!-- 显示效果图 -->
            <section style="margin-top: 50px;z-index: 5">
              <input  id="inputImage"  type="file" accept="image/*" style="display: none;"/>
              <br/>               
              <img id="showImg" />                               
             </section>
<!-- 显示效果图 -->
          </div>
<!-- 显示所选择的头像框 -->
          <div style="z-index: 4">
            <img id = "icon_" src="" style="width:100%;display: block;">           
          </div>  
          </div>
<!-- 显示所选择的头像框  -->     
        </div>
      <div id ="select">
        <img type="button" id="photoBtn" src="img/3butt1.png" onclick="document.getElementById('inputImage').click()" value="选择照片"style="width:100%">
      </div>
      <div id="finish">
        <img onclick="next()" src="img/3butt2.png" alt="666" style="width:100%">
      </div>
    </div>
<!-- 显示裁剪 -->
  <div class="container" style="padding: 0;margin: 0;position:fixed;display: none;top: 0;left: 0;z-index: 200;" id="containerDiv">
      <div class="row" style="display: none;" id="imgEdit">
        <div class="col-md-9">
          <div class="img-container">
            <img src="" alt="Picture">
          </div>
        </div>
      </div>
      <div class="row" id="actions" style="padding: 0;margin: 0;width: 100%;position: fixed;bottom: 5px;">
        <div class="col-md-9 docs-buttons">
          <div class="btn-group" >
            <button type="button" class="btn btn-primary" data-method="destroy" title="Destroy" style="height: auto;">
              <span class="docs-tooltip" data-toggle="tooltip" >
                <span class="fa fa-power-off" >取消</span>
              </span>
            </button>
          </div> 
          <div class="btn-group btn-group-crop " style="float: right;">
            <button type="button" class="btn btn-primary" id="imgCutConfirm" data-method="getCroppedCanvas" data-option="{ &quot;width&quot;: 320, &quot;height&quot;: 180 }" style="height: auto;margin-right: 17px;">
              <span class="docs-tooltip" data-toggle="tooltip" title="">确认</span> 
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
<script type="text/javascript" src="./jquery.min.js" ></script>
<script type="text/javascript" src="./exif.js"></script>
<script type="text/javascript" src="./bootstrap.min.js"></script>
<script type="text/javascript" src="./cropper.js"></script>
<script type="text/javascript" src="./myCrop.js"></script>
<!-- <script>
    document.onreadystatechange = function(){
        if(document.readyState == "complete"){
            $(".loading").fadeOut();
        }
    }
</script> -->
<script type="text/javascript">
  var fileImg = "";
  $(function(){ 
    $("#imgCutConfirm").bind("click",function(){
       $("#containerDiv").hide();
           $("#imgEdit").hide();
           $("#getCroppedCanvasModal").modal("hide");
    })
  }) 
</script>
 <script type="text/javascript">
    function onload(){
      var sen = "Home";  
      var width = document.documentElement.clientWidth;
      var height = document.documentElement.clientHeight;
      var ratio = width / height;
      if (ratio > (1 / 2)) {
        var bodywidth = height * 1 / 2;
        var margin = (width - bodywidth) / 2;
        document.getElementById(sen).style.height= height + 'px';
        document.getElementById(sen).style.width= bodywidth + 'px';
        document.getElementById(sen).style.marginLeft= margin + 'px';
        document.getElementById(sen).style.marginRight= margin + 'px';
      }else if(ratio < (1 / 2)){
        var bodyheight = width * 2 / 1;
        var margin = (height - bodyheight) / 2;
        document.getElementById(sen).style.height = bodyheight + 'px';
        document.getElementById(sen).style.width = width + 'px';
        document.getElementById(sen).style.marginTop = margin + 'px';
        document.getElementById(sen).style.marginBottom = margin + 'px';
      }else{
        document.getElementById(sen).style.height = height + 'px';
        document.getElementById(sen).style.width = width + 'px';
        document.getElementById(sen).style.marginTop = 0 + 'px';
        document.getElementById(sen).style.marginBottom = 0 + 'px';
      }
    }
  onload();
    function get(){
      var num = window.sessionStorage.getItem('num');
      var ratio = 0.78;
      if(num == 1){
        document.getElementById("oo").style.left = 14+"%";
      }
      if(num == 2){
        document.getElementById("oo").style.left = 11+"%";
      }
      if(num == 3){
        document.getElementById("oo").style.left = 9+"%";
        document.getElementById("oo").style.top = 7+"%";
        document.getElementById("icon").style.left = 2+"%";
        // document.getElementById("icon").style.top = 29.5+"%";
        var ratio = 0.85;
      }
      if(num == 4){
        document.getElementById("oo").style.left = 8+"%";
        document.getElementById("icon").style.left = 6+"%";
        document.getElementById("icon").style.top = 8+"%";
      }    
      if(num == 5){
        document.getElementById("oo").style.left = 15+"%";
        document.getElementById("oo").style.top = 20+"%";
        document.getElementById("icon").style.left = 5+"%";
        // document.getElementById("icon").style.top = 29.5+"%";
        var ratio = 0.65; 
      }
      if(num == 6){
        document.getElementById("oo").style.left = 12+"%";
        document.getElementById("oo").style.top = 20+"%";
        document.getElementById("icon").style.left = 6+"%";
        document.getElementById("icon").style.top = 2+"%";
        document.getElementById("icon").style.width = 84.6+"%";
        // var ratio = 
      }
      if(num == 7){
        document.getElementById("icon").style.left = 2+"%";
        document.getElementById("icon").style.top = 5+"%";
      }
      if(num == 8){
        document.getElementById("oo").style.left = 13+"%";
        document.getElementById("oo").style.top = 7+"%";
        document.getElementById("icon").style.top = 2+"%";
      }
      if(num == 9){
        document.getElementById("icon").style.left = 4+"%";
        document.getElementById("icon").style.top = 2+"%";
      }
      var s = "img/"+num.toString()+'.png';
      // console.log(s);
      document.getElementById("icon_").src="img/"+num.toString()+'.png';
      return ratio;
    }
    var ratio = get();
    var w = document.getElementById("icon").offsetWidth*ratio;
    document.getElementById("oo").style.width = w  + 'px';
    document.getElementById("oo").style.height = w + 'px';
    function next(){
      // var base = document.getElementById("showImg").src.substring(0,40);
      // alert(base);
    html2canvas(document.querySelector('.square'),{scale:8,scrollY:0,scrollX:0,useCORS: true}).then(function(canvas) {
            var url = canvas.toDataURL('image/png');
            window.sessionStorage["finalsrc"] = url;
            // var string = url.substring(0,40);
            // alert(string);
            window.location.href = "index4.html";
      window.sessionStorage["src"] = document.getElementById("showImg").src;
     });
      
    }

  </script>
</html>